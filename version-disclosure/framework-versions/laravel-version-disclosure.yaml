id: laravel-version-disclosure

info:
  name: Laravel Framework Version Disclosure
  author: elite-nuclei-templates
  severity: low
  description: Detects Laravel framework version information disclosure through various methods including debug pages, composer files, and error messages
  reference:
    - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/01-Information_Gathering/02-Fingerprint_Web_Server
    - https://laravel.com/docs/security
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-200
  metadata:
    verified: true
    max-request: 16
  tags: info-disclosure,laravel,version,framework,php

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/composer.json"
      - "{{BaseURL}}/composer.lock"
      - "{{BaseURL}}/artisan"
      - "{{BaseURL}}/storage/logs/laravel.log"
      - "{{BaseURL}}/vendor/laravel/framework/src/Illuminate/Foundation/Application.php"
      - "{{BaseURL}}/vendor/composer/installed.json"
      - "{{BaseURL}}/public/mix-manifest.json"
      - "{{BaseURL}}/mix-manifest.json"
      - "{{BaseURL}}/.env"
      - "{{BaseURL}}/config/app.php"
      - "{{BaseURL}}/bootstrap/app.php"
      - "{{BaseURL}}/resources/views/welcome.blade.php"
      - "{{BaseURL}}/public/web.config"
      - "{{BaseURL}}/public/.htaccess"
      - "{{BaseURL}}/telescope"

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        name: "Laravel Debug Page Version"
        regex:
          - "Laravel Framework ([0-9.]+)"
          - "Laravel v([0-9.]+)"
          - "Laravel ([0-9.]+) \\("

      - type: regex
        part: body
        name: "Laravel Composer Version"
        regex:
          - "\"laravel/framework\": \"([0-9.^~]+)\""
          - "\"laravel/laravel\": \"([0-9.^~]+)\""
          - "laravel.*version.*([0-9.]+)"

      - type: regex
        part: body
        name: "Laravel Application Version"
        regex:
          - "const VERSION = '([0-9.]+)'"
          - "Application::VERSION.*([0-9.]+)"
          - "Illuminate\\\\Foundation\\\\Application.*([0-9.]+)"

      - type: regex
        part: body
        name: "Laravel Error Message"
        regex:
          - "Illuminate\\\\.*Exception"
          - "Laravel\\\\.*Exception"
          - "at vendor/laravel/framework"

      - type: word
        part: body
        words:
          - "Laravel"
          - "Illuminate\\"
          - "artisan"
        condition: and

      - type: regex
        part: body
        name: "Laravel Mix Version"
        regex:
          - "mix-manifest.*([0-9.]+)"
          - "Laravel Mix.*([0-9.]+)"

      - type: regex
        part: body
        name: "Laravel Log Version"
        regex:
          - "laravel.log.*([0-9.]+)"
          - "production.ERROR.*Laravel ([0-9.]+)"

      - type: word
        part: body
        words:
          - "blade.php"
          - "@extends"
          - "@section"
        condition: and

      - type: regex
        part: body
        name: "Laravel Telescope"
        regex:
          - "Laravel Telescope"
          - "telescope.*([0-9.]+)"

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - "Laravel Framework ([0-9.]+)"
          - "\"laravel/framework\": \"([0-9.^~]+)\""
          - "const VERSION = '([0-9.]+)'"
          - "Laravel v([0-9.]+)"
          - "Laravel Mix.*([0-9.]+)"
          - "production.ERROR.*Laravel ([0-9.]+)"