id: opencart-version-disclosure

info:
  name: OpenCart Version Disclosure
  author: elite-nuclei-templates
  severity: low
  description: Detects OpenCart version information disclosure through various methods including admin panel, config files, and JavaScript files
  reference:
    - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/01-Information_Gathering/02-Fingerprint_Web_Server
    - https://docs.opencart.com/en-gb/administration/security/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-200
  metadata:
    verified: true
    max-request: 12
  tags: info-disclosure,opencart,version,cms,ecommerce

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/admin/"
      - "{{BaseURL}}/admin/index.php"
      - "{{BaseURL}}/catalog/view/javascript/jquery/jquery-2.1.1.min.js"
      - "{{BaseURL}}/catalog/view/theme/default/stylesheet/stylesheet.css"
      - "{{BaseURL}}/install/"
      - "{{BaseURL}}/install/index.php"
      - "{{BaseURL}}/system/config/catalog.php"
      - "{{BaseURL}}/system/config/admin.php"
      - "{{BaseURL}}/vqmod/"
      - "{{BaseURL}}/image/"
      - "{{BaseURL}}/catalog/controller/common/home.php"

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        name: "OpenCart Generator Meta Tag"
        regex:
          - "<meta name=\"generator\" content=\"OpenCart ([0-9.]+)"
          - "Powered by OpenCart ([0-9.]+)"

      - type: regex
        part: body
        name: "OpenCart Admin Version"
        regex:
          - "OpenCart.*([0-9.]+)"
          - "admin.*OpenCart ([0-9.]+)"
          - "Administration.*([0-9.]+)"

      - type: regex
        part: body
        name: "OpenCart JavaScript Version"
        regex:
          - "opencart.*version.*([0-9.]+)"
          - "oc_version.*([0-9.]+)"
          - "jquery-2.1.1.min.js"

      - type: regex
        part: body
        name: "OpenCart Config Version"
        regex:
          - "VERSION.*([0-9.]+)"
          - "define\\('VERSION', '([0-9.]+)'\\)"
          - "const VERSION = '([0-9.]+)'"

      - type: word
        part: body
        words:
          - "catalog/view/theme"
          - "route=common/home"
          - "index.php?route="
        condition: and

      - type: regex
        part: body
        name: "OpenCart Install Version"
        regex:
          - "OpenCart ([0-9.]+) installation"
          - "install.*version ([0-9.]+)"
          - "Welcome to OpenCart ([0-9.]+)"

      - type: word
        part: body
        words:
          - "var token"
          - "user_token"
          - "catalog/language"
        condition: and

      - type: regex
        part: body
        name: "OpenCart VQMod"
        regex:
          - "vqmod.*([0-9.]+)"
          - "VirtualQMOD.*([0-9.]+)"

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - "<meta name=\"generator\" content=\"OpenCart ([0-9.]+)"
          - "OpenCart.*([0-9.]+)"
          - "define\\('VERSION', '([0-9.]+)'\\)"
          - "OpenCart ([0-9.]+) installation"
          - "vqmod.*([0-9.]+)"