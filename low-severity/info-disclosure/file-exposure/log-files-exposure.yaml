id: log-files-exposure

info:
  name: Log Files Exposure
  author: elite-nuclei-templates
  severity: low
  description: Detects exposed log files that may contain sensitive information
  reference:
    - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/01-Information_Gathering/05-Review_Webpage_Comments_and_Metadata_for_Information_Leakage
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-532
  metadata:
    verified: true
    max-request: 15
  tags: info-disclosure,logs,files,sensitive-data

http:
  - method: GET
    path:
      - "{{BaseURL}}/error.log"
      - "{{BaseURL}}/access.log"
      - "{{BaseURL}}/error_log"
      - "{{BaseURL}}/access_log"
      - "{{BaseURL}}/apache.log"
      - "{{BaseURL}}/nginx.log"
      - "{{BaseURL}}/php_errors.log"
      - "{{BaseURL}}/application.log"
      - "{{BaseURL}}/debug.log"
      - "{{BaseURL}}/laravel.log"
      - "{{BaseURL}}/storage/logs/laravel.log"
      - "{{BaseURL}}/logs/error.log"
      - "{{BaseURL}}/logs/access.log"
      - "{{BaseURL}}/var/log/apache2/error.log"
      - "{{BaseURL}}/log/"

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        name: "Apache Error Log"
        regex:
          - "\\[error\\]"
          - "\\[warn\\]"
          - "\\[notice\\]"
          - "AH[0-9]{5}:"

      - type: regex
        part: body
        name: "Nginx Error Log"
        regex:
          - "\\[error\\]"
          - "\\[warn\\]"
          - "\\[crit\\]"
          - "nginx/[0-9.]+"

      - type: regex
        part: body
        name: "PHP Error Log"
        regex:
          - "PHP Fatal error:"
          - "PHP Warning:"
          - "PHP Notice:"
          - "Stack trace:"

      - type: regex
        part: body
        name: "Application Log"
        regex:
          - "\\[INFO\\]"
          - "\\[ERROR\\]"
          - "\\[DEBUG\\]"
          - "\\[WARN\\]"

      - type: regex
        part: body
        name: "Access Log"
        regex:
          - "GET /"
          - "POST /"
          - "HTTP/1\\.[01]"
          - "[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}"

      - type: word
        part: body
        words:
          - "Index of /logs"
          - "Index of /log"

    extractors:
      - type: regex
        part: body
        regex:
          - "([0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})"
          - "(\\[[0-9]{2}/[A-Za-z]{3}/[0-9]{4}:[0-9]{2}:[0-9]{2}:[0-9]{2})"
          - "(Fatal error: [^\\r\\n]+)"