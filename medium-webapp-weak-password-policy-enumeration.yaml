id: medium-webapp-weak-password-policy-enumeration

info:
  name: Weak Password Policy Enumeration - Elite Detection
  author: nuclei-community
  severity: medium
  description: |
    Detects weak password policy implementations and enumerates password requirements through
    advanced testing techniques. Tests for insufficient complexity requirements, predictable patterns,
    and exploitable password validation mechanisms that can be bypassed or abused.
  reference:
    - https://owasp.org/www-community/Authentication_Cheat_Sheet
    - https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
    cwe-id: CWE-521
  metadata:
    verified: true
    max-request: 35
  tags: password-policy,weak-password,enumeration,authentication,elite

http:
  - method: POST
    path:
      - "{{BaseURL}}/{{path}}"

    payloads:
      path:
        - "register.php"
        - "signup.php"
        - "create_account.php"
        - "user/register"
        - "auth/register"
        - "account/create"
        - "member/signup"
        - "registration.php"
        - "api/register"
        - "api/signup"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: |
      username=testuser&email=test@example.com&password=123&confirm_password=123

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "account created"
          - "registration successful"
          - "user registered"
          - "signup successful"
          - "welcome"
          - "account activated"
        condition: or

      - type: status
        status:
          - 200
          - 302

      - type: word
        part: body
        words:
          - "password too short"
          - "password must contain"
          - "password complexity"
          - "invalid password"
          - "weak password"
        condition: and
        negative: true

  - method: POST
    path:
      - "{{BaseURL}}/{{path}}"

    payloads:
      path:
        - "register.php"
        - "signup.php"
        - "create_account.php"
        - "user/register"
        - "auth/register"
        - "account/create"
        - "member/signup"
        - "registration.php"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: |
      username=testuser2&email=test2@example.com&password={{weak_password}}&confirm_password={{weak_password}}

    payloads:
      weak_password:
        - "a"
        - "12"
        - "abc"
        - "123"
        - "password"
        - "admin"
        - "test"
        - "user"
        - "qwerty"
        - "123456"
        - "password123"
        - "admin123"
        - "test123"
        - "user123"
        - "aaaaaa"
        - "111111"
        - "abcdef"
        - "123abc"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "account created"
          - "registration successful"
          - "user registered"
          - "signup successful"
          - "welcome"
        condition: or

      - type: status
        status:
          - 200
          - 302

  - method: POST
    path:
      - "{{BaseURL}}/{{path}}"

    payloads:
      path:
        - "change_password.php"
        - "update_password.php"
        - "password/change"
        - "account/password"
        - "user/password"
        - "profile/password"
        - "settings/password"
        - "api/password/change"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: |
      current_password=oldpass123&new_password=123&confirm_password=123

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "password changed"
          - "password updated"
          - "password successfully"
          - "changes saved"
          - "password modified"
        condition: or

      - type: status
        status:
          - 200
          - 302

  - method: POST
    path:
      - "{{BaseURL}}/{{path}}"

    payloads:
      path:
        - "reset_password.php"
        - "password_reset.php"
        - "forgot_password.php"
        - "password/reset"
        - "auth/reset"
        - "account/reset"
        - "user/reset"
        - "api/password/reset"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: |
      token=reset_token_123&new_password={{simple_password}}&confirm_password={{simple_password}}

    payloads:
      simple_password:
        - "1"
        - "12"
        - "123"
        - "1234"
        - "12345"
        - "a"
        - "ab"
        - "abc"
        - "abcd"
        - "abcde"
        - "password"
        - "admin"
        - "test"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "password reset"
          - "password updated"
          - "new password set"
          - "password changed"
          - "reset successful"
        condition: or

      - type: status
        status:
          - 200
          - 302

  - method: POST
    path:
      - "{{BaseURL}}/{{path}}"

    payloads:
      path:
        - "login.php"
        - "signin.php"
        - "auth.php"
        - "user/login"
        - "auth/login"
        - "account/login"
        - "member/signin"
        - "api/login"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: |
      username={{common_username}}&password={{common_password}}

    payloads:
      common_username:
        - "admin"
        - "administrator"
        - "root"
        - "user"
        - "test"
        - "guest"
        - "demo"
        - "sa"
        - "operator"
        - "manager"
      common_password:
        - "admin"
        - "password"
        - "123456"
        - "admin123"
        - "password123"
        - "root"
        - "test"
        - "guest"
        - "demo"
        - "123"
        - "1234"
        - "12345"
        - "qwerty"
        - "abc123"
        - "admin@123"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "login successful"
          - "welcome"
          - "dashboard"
          - "logged in"
          - "authentication successful"
          - "session started"
        condition: or

      - type: status
        status:
          - 200
          - 302

      - type: word
        part: body
        words:
          - "invalid credentials"
          - "login failed"
          - "incorrect password"
          - "authentication failed"
          - "access denied"
        condition: and
        negative: true

  - method: GET
    path:
      - "{{BaseURL}}/{{path}}"

    payloads:
      path:
        - "password_policy.php"
        - "password_requirements.php"
        - "password_rules.php"
        - "policy.php"
        - "requirements.php"
        - "rules.php"
        - "help/password"
        - "support/password"
        - "docs/password"
        - "api/password/policy"
        - "api/password/requirements"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "(?i)minimum\\s+length\\s*:?\\s*[1-5]"
          - "(?i)minimum\\s+[1-5]\\s+characters?"
          - "(?i)at\\s+least\\s+[1-5]\\s+characters?"
          - "(?i)password\\s+must\\s+be\\s+[1-5]"
          - "(?i)no\\s+special\\s+characters?\\s+required"
          - "(?i)no\\s+uppercase\\s+required"
          - "(?i)no\\s+numbers?\\s+required"
          - "(?i)simple\\s+passwords?\\s+allowed"

      - type: status
        status:
          - 200

  - method: POST
    path:
      - "{{BaseURL}}/{{path}}"

    payloads:
      path:
        - "api/validate_password"
        - "validate_password.php"
        - "check_password.php"
        - "password/validate"
        - "auth/validate"
        - "user/validate_password"

    headers:
      Content-Type: "application/json"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: |
      {"password":"{{test_password}}"}

    payloads:
      test_password:
        - "1"
        - "12"
        - "123"
        - "1234"
        - "12345"
        - "a"
        - "ab"
        - "abc"
        - "abcd"
        - "password"
        - "admin"
        - "test"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "valid"
          - "accepted"
          - "strong"
          - "good"
          - "ok"
          - "passed"
          - "success"
        condition: or

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - '(?i)minimum\\s+length\\s*:?\\s*([1-9]\\d*)'
          - '(?i)minimum\\s+([1-9]\\d*)\\s+characters?'
          - '(?i)at\\s+least\\s+([1-9]\\d*)\\s+characters?'
          - '(?i)password\\s+must\\s+be\\s+([1-9]\\d*)'
        internal: true